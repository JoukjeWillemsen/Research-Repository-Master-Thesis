library(ggplot2)
lambda = x
lambda_cA = 0
lambda_h = 0
lambda_eA = 0
x = seq(-5,5,0.01)
dataA <- rbind(
data.frame(
group="hist",
x=x,
y=dnorm(x, lambda_h, 1),
lambda = lambda_h),
data.frame(
group="current",
x=x,
y=dnorm(x, lambda_cA, 1),
lambda = lambda_cA),
data.frame(
group="exp",
x=x,
y=-dnorm(x, lambda_eA, 1),
lambda = lambda_eA))
A=ggplot(data = dataA, aes(x=x,y=y, group=group)) +
scale_color_manual(values = c("#999999", "#56B4E9", "#009E73"), name = "") +
geom_segment(aes(x = lambda_h, y = 0, xend = 0, yend = dnorm(lambda_h)), color="#999999") + #hist
annotate("text", x = 0, y = dnorm(lambda_h)+0.06, label = expression(lambda*"h"), color="#999999") +
geom_segment(aes(x = lambda_cA, y = 0, xend = lambda_cA, yend = dnorm(lambda_cA, mean = lambda_cA, sd=1)), color="#56B4E9")+ #hist
annotate("text", x = 0, y = dnorm(lambda_cA)+0.02, label = expression(lambda*"c"), color="#56B4E9") +
geom_segment(aes(x = lambda_eA, y = 0, xend = lambda_eA, yend = -dnorm(lambda_eA, mean = lambda_eA, sd=1)), color="#009E73")+ #exp
annotate("text", x = 0, y = - dnorm(lambda_eA) - 0.04, label = expression(lambda*"e"), color="#009E73") +
geom_area(
aes(fill=group),
alpha=0.2,
position="dodge") +
geom_line(aes(color=group))+
scale_fill_manual(values = c("#999999", "#56B4E9", "#009E73"), name = "") +
scale_x_continuous("", breaks=c()) +
scale_y_continuous("", breaks=c()) +
theme_bw()
# labs(title = "Situation A")
A
library(ggplot2)
lambda_cB = 2
lambda_h = 0
lambda_eB = 2
x=seq(-5,5,0.01)
dataB <- rbind(
data.frame(
group="hist",
x = x,
y=dnorm(x, lambda_h, 1),
lambda = lambda_h),
data.frame(
group="current",
x= x,
y=dnorm(x, lambda_cB, 1),
lambda = lambda_cB),
data.frame(
group="exp",
x= x,
y=-dnorm(x, lambda_eB, 1),
lambda = lambda_eB))
B=ggplot(dataB, aes(x=x,y=y, group=group)) +
scale_color_manual(values = c("#999999", "#56B4E9", "#009E73"), name = "") + #specify colours
geom_segment(aes(x = lambda_h, y = 0, xend = 0, yend = dnorm(lambda_h)), color="#999999") + #hist
annotate("text", x = lambda_h, y = dnorm(lambda_h, mean = lambda_h, sd = 1)+0.04, label = expression(lambda*"h"), color="#999999") +
geom_segment(aes(x = lambda_cB, y = 0, xend = lambda_cB, yend = dnorm(lambda_cB, mean = lambda_cB, sd=1)), color="#56B4E9")+ #hist
annotate("text", x = lambda_cB, y = dnorm(lambda_cB, mean = lambda_cB, sd = 1)+0.04, label = expression(lambda*"c"), color="#56B4E9") +
geom_segment(aes(x = lambda_eB, y = 0, xend = lambda_eB, yend = -dnorm(lambda_eB, mean = lambda_eB, sd=1)), color="#009E73")+ #exp
annotate("text", x = lambda_eB, y = - dnorm(lambda_eB, mean = lambda_eB, sd = 1) - 0.04, label = expression(lambda*"e"), color="#009E73") +
#fill the plots
geom_area(
aes(fill=group),
alpha=0.2,
position="dodge") +
#add legend
geom_line(aes(color=group))+
scale_fill_manual(values = c("#999999", "#56B4E9", "#009E73"), name = "") +
#remove breaks
scale_x_continuous("", breaks=c()) +
scale_y_continuous("", breaks=c()) +
theme_bw()
#Plot B
B
#Plot B
B
#specify average lambda's
lambda_cC = 0
lambda_h = 0
lambda_eC = 0
#make dataframe control data
lambda_cClist <-
rbind(
data.frame(name = lambda_cC1,
mean = -2),
data.frame(name = lambda_cC2,
mean = -1),
data.frame(name = lambda_cC3,
mean = 0),
data.frame(name = lambda_cC4,
mean = 1),
data.frame(name = lambda_cC5,
mean = 2))
#specify average lambda's
lambda_cC = 0
lambda_h = 0
lambda_eC = 0
#specify the lamda's of the subgroups
lambda_cC1 = -2
lambda_cC2 = -1
lambda_cC3 = 0
lambda_cC4 = 1
lambda_cC5 = 2
lambda_eC1 = -2
lambda_eC2 = -1
lambda_eC3 = 0
lambda_eC4 = 1
lambda_eC5 = 2
#Make dataset data c
dataC <- rbind(
data.frame(
niveau="pophist",
group="hist",
x=seq(-5,5,0.01),
y=5*dnorm(x, lambda_h, 1.7),
lambda = lambda_h),
data.frame(
niveau="popcont",
group="current",
x=seq(-5,5,0.01),
y=5*dnorm(x, lambda_cC, 1.7),
lambda = lambda_cC),
data.frame(
niveau="popexp",
group="exp",
x=seq(-5,5,0.01),
y=-5*dnorm(x, lambda_eC, 1.7),
lambda = lambda_eC),
data.frame(
niveau="exp",
group="lambda_eC1",
x=seq(-5,5,0.01),
y=-dnorm(x, lambda_eC1, 1),
lambda = lambda_eC1),
data.frame(
niveau="exp",
group="lambda_eC2",
x=seq(-5,5,0.01),
y=-dnorm(x, lambda_eC2, 1),
lambda = lambda_eC2),
data.frame(
niveau="exp",
group="lambda_eC3",
x=seq(-5,5,0.01),
y=-dnorm(x, lambda_eC3, 1),
lambda = lambda_eC3),
data.frame(
niveau="exp",
group="lambda_eC4",
x=seq(-5,5,0.01),
y=-dnorm(x, lambda_eC4, 1),
lambda = lambda_eC4),
data.frame(
niveau="exp",
group="lambda_eC5",
x=seq(-5,5,0.01),
y=-dnorm(x, lambda_eC5, 1),
lambda = lambda_eC5),
data.frame(
niveau="current",
group="lambda_cC1",
x=seq(-5,5,0.01),
y=dnorm(x, lambda_cC1, 1),
lambda = lambda_cC1),
data.frame(
niveau="current",
group="lambda_cC2",
x=seq(-5,5,0.01),
y=dnorm(x, lambda_cC2, 1),
lambda = lambda_cC2),
data.frame(
niveau="current",
group="lambda_cC3",
x=seq(-5,5,0.01),
y=dnorm(x, lambda_cC3, 1),
lambda = lambda_cC3),
data.frame(
niveau="current",
group="lambda_cC4",
x=seq(-5,5,0.01),
y=dnorm(x, lambda_cC4, 1),
lambda = lambda_cC4),
data.frame(
niveau="current",
group="lambda_cC5",
x=seq(-5,5,0.01),
y=dnorm(x, lambda_cC5, 1),
lambda = lambda_cC5))
#make dataframe subgroups control data
lambda_cClist <-
rbind(
data.frame(name = lambda_cC1,
mean = -2),
data.frame(name = lambda_cC2,
mean = -1),
data.frame(name = lambda_cC3,
mean = 0),
data.frame(name = lambda_cC4,
mean = 1),
data.frame(name = lambda_cC5,
mean = 2))
#make dataframe subgroups experimental data
lambda_eClist <-
rbind(
data.frame(name = lambda_eC1,
mean = -2),
data.frame(name = lambda_eC2,
mean = -1),
data.frame(name = lambda_eC3,
mean = 0),
data.frame(name = lambda_eC4,
mean = 1),
data.frame(name = lambda_eC5,
mean = 2))
C=ggplot(data=dataC, aes(x=x,y=y, group=group)) +
scale_color_manual(values = c("#999999", "#56B4E9", "#009E73", "#009E73", "#56B4E9"), name = "") + #rood #009E73 blauw #009E73 blauw
## add lines & fillings
geom_segment(aes(x = lambda_h, y = 0, xend = 0, yend = 5*dnorm(lambda_h, mean=lambda_h, sd=1.7)), color="#999999") + #hist
annotate("text", x = lambda_h, y = 0.3+5*dnorm(lambda_h, mean = lambda_h, sd = 1.7), label = expression(lambda*"h"), color="#999999") +
geom_segment(aes(x = lambda_cC, y = 0, xend = lambda_cC, yend = -5*dnorm(lambda_cC, mean = lambda_cC, sd=1.7)), color="#009E73")+ #hist
annotate("text", x = lambda_eC, y = -0.08 + -5*dnorm(lambda_eC, mean = lambda_eC, sd = 1.7), label = expression(lambda*"e"), color="#009E73") +
geom_segment(aes(x = lambda_eC, y = 0, xend = lambda_eC, yend = 5*dnorm(lambda_eC, mean = lambda_eC, sd=1.7)), color="#56B4E9") +
annotate("text", x = lambda_cC, y = 0.07+5*dnorm(lambda_cC, mean = lambda_cC, sd = 1.7), label = expression(lambda*"c"), color="#56B4E9") +
### annotate smaller c's ###
#1
geom_segment(aes(x = lambda_eClist$mean[1], y = 0, xend = lambda_eClist$mean[1], yend = -dnorm(lambda_eClist$mean[1], mean = lambda_eClist$mean[1], sd=1)), color="#009E73")+ #exp
annotate("text", x = lambda_eClist$mean[1], y = -0.08 - dnorm(lambda_eClist$mean[1], mean = lambda_eClist$mean[1], sd = 1), label = expression(lambda*"e1"), color="#009E73") +
#2
geom_segment(aes(x = lambda_eClist$mean[2], y = 0, xend = lambda_eClist$mean[2], yend = -dnorm(lambda_eClist$mean[2], mean = lambda_eClist$mean[2], sd=1)), color="#009E73")+ #exp
annotate("text", x = lambda_eClist$mean[2], y = -0.08 - dnorm(lambda_eClist$mean[2], mean = lambda_eClist$mean[2], sd = 1), label = expression(lambda*"e2"), color="#009E73") +
#3
geom_segment(aes(x = lambda_eClist$mean[3], y = 0, xend = lambda_eClist$mean[3], yend = -dnorm(lambda_eClist$mean[3], mean = lambda_eClist$mean[3], sd=1)), color="#009E73")+ #exp
annotate("text", x = lambda_eClist$mean[3], y = -0.08 - dnorm(lambda_eClist$mean[3], mean = lambda_eClist$mean[3], sd = 1), label = expression(lambda*"e3"), color="#009E73") +
#4
geom_segment(aes(x = lambda_eClist$mean[4], y = 0, xend = lambda_eClist$mean[4], yend = -dnorm(lambda_eClist$mean[4], mean = lambda_eClist$mean[4], sd=1)), color="#009E73")+ #exp
annotate("text", x = lambda_eClist$mean[4], y = -0.08 - dnorm(lambda_eClist$mean[4], mean = lambda_eClist$mean[4], sd = 1), label = expression(lambda*"e4"), color="#009E73") +
#5
geom_segment(aes(x = lambda_eClist$mean[5], y = 0, xend = lambda_eClist$mean[5], yend = -dnorm(lambda_eClist$mean[5], mean = lambda_eClist$mean[5], sd=1)), color="#009E73")+ #exp
annotate("text", x = lambda_eClist$mean[5], y = -0.08 - dnorm(lambda_eClist$mean[5], mean = lambda_eClist$mean[5], sd = 1), label = expression(lambda*"e5"), color="#009E73") +
### annotate smaller e's ###
#1
geom_segment(aes(x = lambda_cClist$mean[1], y = 0, xend = lambda_cClist$mean[1], yend = dnorm(lambda_cClist$mean[1], mean = lambda_cClist$mean[1], sd=1)), color="#56B4E9")+ #exp
annotate("text", x = lambda_cClist$mean[1], y = +0.08 + dnorm(lambda_cClist$mean[1], mean = lambda_cClist$mean[1], sd = 1), label = expression(lambda*"c1"), color="#56B4E9") +
#2
geom_segment(aes(x = lambda_cClist$mean[2], y = 0, xend = lambda_cClist$mean[2], yend = dnorm(lambda_cClist$mean[2], mean = lambda_cClist$mean[2], sd=1)), color="#56B4E9")+ #exp
annotate("text", x = lambda_cClist$mean[2], y = +0.08 + dnorm(lambda_cClist$mean[2], mean = lambda_cClist$mean[2], sd = 1), label = expression(lambda*"c2"), color="#56B4E9") +
#3
geom_segment(aes(x = lambda_cClist$mean[3], y = 0, xend = lambda_cClist$mean[3], yend = dnorm(lambda_cClist$mean[3], mean = lambda_cClist$mean[3], sd=1)), color="#56B4E9")+ #exp
annotate("text", x = lambda_cClist$mean[3], y = +0.08 + dnorm(lambda_cClist$mean[3], mean = lambda_cClist$mean[3], sd = 1), label = expression(lambda*"c3"), color="#56B4E9") +
#4
geom_segment(aes(x = lambda_cClist$mean[4], y = 0, xend = lambda_cClist$mean[4], yend = dnorm(lambda_cClist$mean[4], mean = lambda_cClist$mean[4], sd=1)), color="#56B4E9")+ #exp
annotate("text", x = lambda_cClist$mean[4], y = +0.08 + dnorm(lambda_cClist$mean[4], mean = lambda_cClist$mean[4], sd = 1), label = expression(lambda*"c4"), color="#56B4E9") +
#5
geom_segment(aes(x = lambda_cClist$mean[5], y = 0, xend = lambda_cClist$mean[5], yend = dnorm(lambda_cClist$mean[5], mean = lambda_cClist$mean[5], sd=1)), color="#56B4E9")+ #exp
annotate("text", x = lambda_cClist$mean[5], y = +0.08 + dnorm(lambda_cClist$mean[5], mean = lambda_cClist$mean[5], sd = 1), label = expression(lambda*"c5"), color="#56B4E9") +
#add legend
scale_fill_manual(values = c("#999999", "#FFFFFF", "#FFFFFF", "#009E73", "#56B4E9"), name = "") +
scale_linetype_manual(values = c("solid", "dotted", "dotted", "solid", "solid"), name = "") +
geom_area(aes(fill=niveau), alpha=0.3, position="dodge") +
geom_line(aes(color=niveau, linetype=niveau))+
#remove breaks
scale_x_continuous("", breaks=c()) +
scale_y_continuous("", breaks=c()) +
theme_bw()
C
C
