---
title: "Data visualization plots scenario A,B,E,F"
author: "Joukje Willemsen"
date: "14-05-20"
output: html_document
---
In this document the TPR/FPR trade-off is plotted relative to the proportion of datasets pooled for every poolingmethod and every decisionthreshold in every simulated scenario, referred to as A, B, E1-3 and F1-3 in the article.

Please note that:

Data11 = Scenario A

Data12 = Scenario E1

Data13 = Scenario E2

Data14 = Scenario E3

Data21 = Scenario B

Data22 = Scenario F1

Data23 = Scenario F2

Data24 = Scenario F3

#Load packages
```{r}
library(dplyr) 
library(survival) 
library(ggplot2)
library(cowplot)
```

#make function npool
```{r}
npool <- function(dataset, dat=1){
  #PoolDecisions$TTP = PoolDecisions$TTP
propvector<-vector()
for (i in 1:length(dataset)){
  propvector[i]<-sum(dataset[[i]][[dat]]=="pool")
}
return(propvector/1000)
}
```

#Make a function that returns a vector with the TPs, and a vector with the FPs for the indicated dataset
```{r}
makeDF <- function(proportions, dat=1){ #example: proportions$PHR
TP <- vector()
FP <- vector()
for (i in 1:length(proportions)){
TP[i] = proportions[[i]][dat,3]
FP[i] = proportions[[i]][dat,4]
}
data <- data.frame(TP = TP, FP=FP)
return(data)
}
#plot(TP, FP)
```


#Make a function that returns a list with matrices with proportions TP, FP, and how much is pooled
```{r}
#for the pooled datasets
giveproportions <- function(poolingmethod){
  #input: poolingmethod = decisions$poolingmethod
  proportions <- list()
  for (i in 1:length(poolingmethod)){
    proportions[[i]] <- matrix(NA, nrow = 8, ncol = 5)
    rownames(proportions[[i]])<- c("Data11","Data12","Data13","Data14","Data21","Data22","Data23","Data24")
    colnames(proportions[[i]])<- c("TP", "FP", "TP_prop", "FP_prop", "TP/FP")
    
    for(a in 1:8){
      proportions[[i]][a,1] <- sum(poolingmethod[[i]][[a]][,1][1:1000])
      proportions[[i]][a,2] <- sum(poolingmethod[[i]][[a]][,2][1:1000])
      proportions[[i]][a,3] <- sum(poolingmethod[[i]][[a]][,1][1:1000]/1000)
      proportions[[i]][a,4] <- sum(poolingmethod[[i]][[a]][,2][1:1000]/1000)
      proportions[[i]][a,5] <- proportions[[i]][a,3]/proportions[[i]][a,4]
    }}
  return(proportions)
}

#for the datasets where either nothing is pooled or everything is pooled
giveproportionsNOpool <- function(poolingmethod){
  #input: poolingmethod = decisions$poolingmethod
  proportions <- list()
  for (i in 1:length(poolingmethod)){
    proportions <- matrix(NA, nrow = 8, ncol = 5)
    rownames(proportions)<- c("Data11","Data12","Data13","Data14","Data21","Data22","Data23","Data24")
    colnames(proportions)<- c("TP", "FP", "TP_prop", "FP_prop", "TP/FP")
    for(a in 1:8){
      proportions[a,1] <- sum(poolingmethod[[a]][,1][1:1000])
      proportions[a,2] <- sum(poolingmethod[[a]][,2][1:1000])
      proportions[a,3] <- sum(poolingmethod[[a]][,1][1:1000]/1000)
      proportions[a,4] <- sum(poolingmethod[[a]][,2][1:1000]/1000)
      proportions[a,5] <-  proportions[a,3]/proportions[a,4]
    }}
  return(proportions)
}
```

#make a function that plots the TPR/FPR trade-off relative to the proportion pooled for the left graph
```{r}
proportionsplot <- function(dat=1, setyaxis, xlim = c(0, 1), TPFPalwayspool, TPFPneverpool){
dataframeTTP <- data.frame(
  "TPFP" = makeDF(proportions = proportions$PPTTP, dat=dat)[,1]/makeDF(proportions = proportions$PPTTP, dat=dat)[,2], 
  "proportionpooled"= npool(dataset = PoolDecisions$TTP, dat=dat))

dataframeHR <- data.frame(
  "TPFP" = makeDF(proportions = proportions$PHR, dat=dat)[,1]/makeDF(proportions = proportions$PHR, dat=dat)[,2], 
  "proportionpooled"= npool(dataset = PoolDecisions$CIsHR, dat=dat))

dataframeHRboot <- data.frame(
  "TPFP" = makeDF(proportions = proportions$PHRboot, dat=dat)[,1]/makeDF(proportions = proportions$PHRboot, dat=dat)[,2], 
  "proportionpooled"= npool(dataset = PoolDecisions$BootCIsHR, dat=dat))

dataframerMean <- data.frame(
  "TPFP" = makeDF(proportions = proportions$RMEANdiff, dat=dat)[,1]/makeDF(proportions = proportions$RMEANdiff, dat=dat)[,2], 
  "proportionpooled"= npool(dataset = PoolDecisions$CIsRMEANdiff, dat=dat))

dataframerMeanBoot <- data.frame(
  "TPFP" = makeDF(proportions = proportions$PRMEANbootdiff, dat=dat)[,1]/makeDF(proportions = proportions$PRMEANbootdiff, dat=dat)[,2], 
  "proportionpooled"= npool(dataset = PoolDecisions$BootCIsRMEANdiff, dat=dat))

plot <- ggplot(dataframeHR, aes(x=proportionpooled, y=TPFP))+
  geom_point(data= dataframeHR,  aes(x=proportionpooled, y=TPFP, colour = "HReq"), size = 3, show.legend = TRUE)+
  geom_path(data= dataframeHR,  aes(x=proportionpooled, y=TPFP, colour = "HReq"), size = 1)+

  geom_point(data= dataframeHRboot,  aes(x=proportionpooled, y=TPFP, colour = "HRboot"), size = 3)+
  geom_path(data= dataframeHRboot,  aes(x=proportionpooled, y=TPFP, colour = "HRboot"), size = 1)+

  geom_point(data= dataframeTTP,  aes(x=proportionpooled, y=TPFP, colour = "HRdiff"), size = 3)+
  geom_path(data= dataframeTTP,  aes(x=proportionpooled, y=TPFP, colour = "HRdiff"), size = 1)+
  
  geom_point(data= dataframerMeanBoot,  aes(x=proportionpooled, y=TPFP, colour = "RMSTboot"), size = 3)+
  geom_path(data= dataframerMeanBoot,  aes(x=proportionpooled, y=TPFP, colour = "RMSTboot"), size = 1)+

    geom_point(data= dataframerMean,  aes(x=proportionpooled, y=TPFP, colour = "RMST"), size = 3)+
  geom_path(data= dataframerMean,  aes(x=proportionpooled, y=TPFP, colour = "RMST"), size = 1)+
  
    geom_point(data= dataframerMeanBoot,  aes(x=proportionpooled, y=TPFP, colour = "RMSTboot"), size = 3)+
  geom_path(data= dataframerMeanBoot,  aes(x=proportionpooled, y=TPFP, colour = "RMSTboot"), size = 1)+

scale_color_manual("", breaks = c("HRdiff" = "HRdiff", "RMSTboot"= "RMSTboot", "RMST" = "RMST", "HRboot" ="HRboot", "HReq" = "HReq"),
                        values=cbPalette)+

geom_hline(aes(yintercept= TPFPalwayspool, linetype = "AlwaysPool"), colour= 'black', size = 1) +
geom_hline(aes(yintercept= TPFPneverpool, linetype = "NeverPool"), colour= 'black', size = 1) +

scale_linetype_manual(name = "", values = c(1, 2), 
                      guide = guide_legend(override.aes = list(values = c(1, 2),
                        color = c("black", "black"), shape = c("", ""))))+

  
coord_cartesian(ylim = setyaxis) + 
  
xlab("Proportion of the datasets pooled") +
ylab("TPR/FPR") +
  
scale_x_continuous(limits = xlim) +
  
theme(aspect.ratio = 0.5)+
  
theme_cowplot(12)

return(plot)}

```

#######################################
############# HR ######################
#######################################

#Load output from 3.FinalAnalysis
```{r}
load("3.FinalAnalysis_output/3.ProportionsTPFPHRShape.Rdata")
load("3.FinalAnalysis_output/3.DecisionsFinalAnalysesHRShape.Rdata")
load("3.FinalAnalysis_output/3.Pooldecisions400HRShape.Rdata") 
```

#Apply function PROPORTIONS
```{r}
proportions<-list()
 
#Apply first function
proportions$PPTTP<- giveproportions(Decisions$PTTP)
proportions$PRMEANbootdiff <- giveproportions(Decisions$PRMEANbootdiff)
proportions$RMEANdiff <-giveproportions(Decisions$PRMEANdiff)
proportions$PHRboot <- giveproportions(Decisions$PHRboot)
proportions$PHR <- giveproportions(Decisions$PHR)

#Apply second function
proportions$PNeverPool <- giveproportionsNOpool(Decisions$PNeverPool) 
proportions$PAlwaysPool <- giveproportionsNOpool(Decisions$PAlwaysPool)
```

#Make 1 big plot, TP/FP prop for the whole dataset!
```{r}
#D11
D11 <- proportionsplot(dat = 1, setyaxis = c(proportions$PNeverPool[1,5]-(0.6*abs(proportions$PAlwaysPool[1,5]-proportions$PNeverPool[1,5])),
                                            proportions$PAlwaysPool[1,5]+(0.05*abs(proportions$PAlwaysPool[1,5]-proportions$PNeverPool[1,5]))), 
                            xlim = c(0,1), TPFPalwayspool = proportions$PAlwaysPool[1,5], TPFPneverpool = proportions$PNeverPool[1,5])

#D12
D12 <- proportionsplot(dat = 2, setyaxis = c(proportions$PNeverPool[2,5]+(0.05*abs(proportions$PAlwaysPool[2,5]-proportions$PNeverPool[2,5])),
                                            proportions$PAlwaysPool[2,5]-(0.6*abs(proportions$PAlwaysPool[2,5]-proportions$PNeverPool[2,5]))), 
                            xlim = c(0,1), TPFPalwayspool = proportions$PAlwaysPool[2,5], TPFPneverpool = proportions$PNeverPool[2,5])

#D13
D13 <- proportionsplot(dat = 3, setyaxis = c(proportions$PAlwaysPool[3,5]-(0.05*abs(proportions$PAlwaysPool[3,5]-proportions$PNeverPool[3,5])),
proportions$PNeverPool[3,5]+(0.05*abs(proportions$PAlwaysPool[3,5]-proportions$PNeverPool[3,5]))), 
xlim = c(0,1), TPFPalwayspool = proportions$PAlwaysPool[3,5], TPFPneverpool = proportions$PNeverPool[3,5])

#D14
D14 <- proportionsplot(dat = 4, setyaxis = c(proportions$PAlwaysPool[4,5]-(0.05*abs(proportions$PAlwaysPool[4,5]-proportions$PNeverPool[4,5])),
proportions$PNeverPool[4,5]+(0.05*abs(proportions$PAlwaysPool[4,5]-proportions$PNeverPool[4,5]))), 
xlim = c(0,1), TPFPalwayspool = proportions$PAlwaysPool[4,5], TPFPneverpool = proportions$PNeverPool[4,5])

D21 <- proportionsplot(dat = 5, setyaxis = c(proportions$PAlwaysPool[5,5]-(0.05*abs(proportions$PAlwaysPool[5,5]-proportions$PNeverPool[5,5])),
proportions$PNeverPool[5,5]+(0.05*abs(proportions$PAlwaysPool[5,5]-proportions$PNeverPool[5,5]))), 
xlim = c(0,1), TPFPalwayspool = proportions$PAlwaysPool[5,5], TPFPneverpool = proportions$PNeverPool[5,5])

D22 <- proportionsplot(dat = 6, setyaxis = c(proportions$PAlwaysPool[6,5]-(0.05*abs(proportions$PAlwaysPool[6,5]-proportions$PNeverPool[6,5])),
proportions$PNeverPool[6,5]+(0.05*abs(proportions$PAlwaysPool[6,5]-proportions$PNeverPool[6,5]))), 
xlim = c(0,1), TPFPalwayspool = proportions$PAlwaysPool[6,5], TPFPneverpool = proportions$PNeverPool[6,5])

D23 <- proportionsplot(dat = 7, setyaxis = c(proportions$PAlwaysPool[7,5]-(0.05*abs(proportions$PAlwaysPool[7,5]-proportions$PNeverPool[7,5])),
proportions$PNeverPool[7,5]+(0.05*abs(proportions$PAlwaysPool[7,5]-proportions$PNeverPool[7,5]))), 
xlim = c(0,1), TPFPalwayspool = proportions$PAlwaysPool[7,5], TPFPneverpool = proportions$PNeverPool[7,5])

D24 <- proportionsplot(dat = 8, setyaxis = c(proportions$PAlwaysPool[8,5]-(0.05*abs(proportions$PAlwaysPool[4,5]-proportions$PNeverPool[8,5])),
proportions$PNeverPool[8,5]+(0.05*abs(proportions$PAlwaysPool[8,5]-proportions$PNeverPool[8,5]))), 
xlim = c(0,1), TPFPalwayspool = proportions$PAlwaysPool[8,5], TPFPneverpool = proportions$PNeverPool[8,5])

arrangedfigure <- ggpubr::ggarrange(D11, D21, D12, D22, D13, D23, D14, D24, 
#         labels = c("D11", "D21", "D12", "D22", "D13", "D23", "D14", "D24"),
         labels = c(" A ", " B ","C1", "D1", "C2", "D2", "C3", "D3"),
          ncol = 2, nrow = 4, common.legend = TRUE, vjust = +1.3, hjust = -1.8, align = "hv", legend = "bottom")

annotatedfigureHRprop <- ggpubr::annotate_figure(arrangedfigure, 
               top = ggpubr::text_grob(expression(paste(lambda["c"],"= 776.89                                   ",lambda["c"],"= 876.89")), face = "bold", size = 20), 
              left = ggpubr::text_grob(expression(paste(gamma["c"],"=2.184                ", gamma["c"], "=2.02                ", gamma["c"], "=1.85                ", gamma["c"], "=1.68")), face = "bold", size = 20, rot = 90))

annotatedfigureHRprop
```


#######################################
############# RMST ####################
#######################################

#Load output from 3.FinalAnalysis
```{r}
load("3.FinalAnalysis_output/3.ProportionsTPFPrmeanShape.Rdata") 
load("3.FinalAnalysis_output/3.DecisionsFinalAnalyses400rmean3Shape.Rdata")
load("3.FinalAnalysis_output/3.Pooldecisions400rmean3Shape.Rdata") 
```

#Make a function that returns a vector with the TPs, and a vector with the FPs for the indicated dataset
```{r}
makeDF <- function(proportions, dat=1){ #example: proportions$PHR
TP <- vector()
FP <- vector()
for (i in 1:length(proportions)){
TP[i] = proportions[[i]][dat,3]
FP[i] = proportions[[i]][dat,4]
}
data <- data.frame(TP = TP, FP=FP)
return(data)
}
#plot(TP, FP)
```

#Apply function PROPORTIONS
```{r}
proportions<-list()
 
#Apply first function
proportions$PPTTP<- giveproportions(Decisions$PTTP)
proportions$PRMEANbootdiff <- giveproportions(Decisions$PRMEANbootdiff)
proportions$RMEANdiff <-giveproportions(Decisions$PRMEANdiff)
proportions$PHRboot <- giveproportions(Decisions$PHRboot)
proportions$PHR <- giveproportions(Decisions$PHR)

#Apply second function
proportions$PNeverPool <- giveproportionsNOpool(Decisions$PNeverPool) 
proportions$PAlwaysPool <- giveproportionsNOpool(Decisions$PAlwaysPool)
```

```{r}
proportionsplot <- function(dat=1, setyaxis, xlim = c(0, 1), TPFPalwayspool, TPFPneverpool){
dataframeTTP <- data.frame(
  "TPFP" = makeDF(proportions = proportions$PPTTP, dat=dat)[,1]/makeDF(proportions = proportions$PPTTP, dat=dat)[,2], 
  "proportionpooled"= npool(dataset = PoolDecisions$TTP, dat=dat))

dataframeHR <- data.frame(
  "TPFP" = makeDF(proportions = proportions$PHR, dat=dat)[,1]/makeDF(proportions = proportions$PHR, dat=dat)[,2], 
  "proportionpooled"= npool(dataset = PoolDecisions$CIsHR, dat=dat))

dataframeHRboot <- data.frame(
  "TPFP" = makeDF(proportions = proportions$PHRboot, dat=dat)[,1]/makeDF(proportions = proportions$PHRboot, dat=dat)[,2], 
  "proportionpooled"= npool(dataset = PoolDecisions$BootCIsHR, dat=dat))

dataframerMean <- data.frame(
  "TPFP" = makeDF(proportions = proportions$RMEANdiff, dat=dat)[,1]/makeDF(proportions = proportions$RMEANdiff, dat=dat)[,2], 
  "proportionpooled"= npool(dataset = PoolDecisions$CIsRMEANdiff, dat=dat))

dataframerMeanBoot <- data.frame(
  "TPFP" = makeDF(proportions = proportions$PRMEANbootdiff, dat=dat)[,1]/makeDF(proportions = proportions$PRMEANbootdiff, dat=dat)[,2], 
  "proportionpooled"= npool(dataset = PoolDecisions$BootCIsRMEANdiff, dat=dat))

plot <- ggplot(dataframeHR, aes(x=proportionpooled, y=TPFP))+
  geom_point(data= dataframeHR,  aes(x=proportionpooled, y=TPFP, colour = "HReq"), size = 3, show.legend = TRUE)+
  geom_path(data= dataframeHR,  aes(x=proportionpooled, y=TPFP, colour = "HReq"), size = 1)+

  geom_point(data= dataframeHRboot,  aes(x=proportionpooled, y=TPFP, colour = "HRboot"), size = 3)+
  geom_path(data= dataframeHRboot,  aes(x=proportionpooled, y=TPFP, colour = "HRboot"), size = 1)+

  geom_point(data= dataframeTTP,  aes(x=proportionpooled, y=TPFP, colour = "HRdiff"), size = 3)+
  geom_path(data= dataframeTTP,  aes(x=proportionpooled, y=TPFP, colour = "HRdiff"), size = 1)+
  
  geom_point(data= dataframerMeanBoot,  aes(x=proportionpooled, y=TPFP, colour = "RMSTboot"), size = 3)+
  geom_path(data= dataframerMeanBoot,  aes(x=proportionpooled, y=TPFP, colour = "RMSTboot"), size = 1)+

    geom_point(data= dataframerMean,  aes(x=proportionpooled, y=TPFP, colour = "RMST"), size = 3)+
  geom_path(data= dataframerMean,  aes(x=proportionpooled, y=TPFP, colour = "RMST"), size = 1)+
  
    geom_point(data= dataframerMeanBoot,  aes(x=proportionpooled, y=TPFP, colour = "RMSTboot"), size = 3)+
  geom_path(data= dataframerMeanBoot,  aes(x=proportionpooled, y=TPFP, colour = "RMSTboot"), size = 1)+

scale_color_manual("", breaks = c("HRdiff" = "HRdiff", "RMSTboot"= "RMSTboot", "RMST" = "RMST", "HRboot" ="HRboot", "HReq" = "HReq"),
                        values=cbPalette)+

geom_hline(aes(yintercept= TPFPalwayspool, linetype = "AlwaysPool"), colour= 'black', size = 1) +
geom_hline(aes(yintercept= TPFPneverpool, linetype = "NeverPool"), colour= 'black', size = 1) +

#scale_linetype_manual(name = "", values = c(1, 2), 
#                      guide = guide_legend(override.aes = list(values = c(1, 2),
#                        color = c("black", "black"), shape = c("", ""))))+

  
coord_cartesian(ylim = setyaxis) + 
  
xlab("Proportion of the datasets pooled") +
ylab("TPR/FPR") +
  
scale_x_continuous(limits = xlim) +
  
theme(aspect.ratio = 0.5)+
  
guides(linetype=FALSE) +
  
guides(shape = guide_legend(override.aes = list(linetype = 0)))+

  
#guides(linetype=FALSE) +
  
theme_cowplot(12)

return(plot)}

```

#Plot seperately

```{r}
#D11
D11 <- proportionsplot(dat = 1, setyaxis = c(proportions$PNeverPool[1,5]-(0.4*abs(proportions$PAlwaysPool[1,5]-proportions$PNeverPool[1,5])),
                                            proportions$PAlwaysPool[1,5]+(0.1*abs(proportions$PAlwaysPool[1,5]-proportions$PNeverPool[1,5]))), 
                            xlim = c(0,1), TPFPalwayspool = proportions$PAlwaysPool[1,5], TPFPneverpool = proportions$PNeverPool[1,5])

#D12
D12 <- proportionsplot(dat = 2, setyaxis = c(proportions$PNeverPool[2,5]+(0.1*abs(proportions$PAlwaysPool[2,5]-proportions$PNeverPool[2,5])),
                                            proportions$PAlwaysPool[2,5]-(0.1*abs(proportions$PAlwaysPool[2,5]-proportions$PNeverPool[2,5]))), 
                            xlim = c(0,1), TPFPalwayspool = proportions$PAlwaysPool[2,5], TPFPneverpool = proportions$PNeverPool[2,5])

#D13
D13 <- proportionsplot(dat = 3, setyaxis = c(proportions$PAlwaysPool[3,5]-(0.1*abs(proportions$PAlwaysPool[3,5]-proportions$PNeverPool[3,5])),
proportions$PNeverPool[3,5]+(0.1*abs(proportions$PAlwaysPool[3,5]-proportions$PNeverPool[3,5]))), 
xlim = c(0,1), TPFPalwayspool = proportions$PAlwaysPool[3,5], TPFPneverpool = proportions$PNeverPool[3,5])

#D14
D14 <- proportionsplot(dat = 4, setyaxis = c(proportions$PAlwaysPool[4,5]-(0.1*abs(proportions$PAlwaysPool[4,5]-proportions$PNeverPool[4,5])),
proportions$PNeverPool[4,5]+(0.1*abs(proportions$PAlwaysPool[4,5]-proportions$PNeverPool[4,5]))), 
xlim = c(0,1), TPFPalwayspool = proportions$PAlwaysPool[4,5], TPFPneverpool = proportions$PNeverPool[4,5])

D21 <- proportionsplot(dat = 5, setyaxis = c(proportions$PAlwaysPool[5,5]-(0.1*abs(proportions$PAlwaysPool[5,5]-proportions$PNeverPool[5,5])),
proportions$PNeverPool[5,5]+(0.1*abs(proportions$PAlwaysPool[5,5]-proportions$PNeverPool[5,5]))), 
xlim = c(0,1), TPFPalwayspool = proportions$PAlwaysPool[5,5], TPFPneverpool = proportions$PNeverPool[5,5])

D22 <- proportionsplot(dat = 6, setyaxis = c(proportions$PAlwaysPool[6,5]-(0.1*abs(proportions$PAlwaysPool[6,5]-proportions$PNeverPool[6,5])),
proportions$PNeverPool[6,5]+(0.1*abs(proportions$PAlwaysPool[6,5]-proportions$PNeverPool[6,5]))), 
xlim = c(0,1), TPFPalwayspool = proportions$PAlwaysPool[6,5], TPFPneverpool = proportions$PNeverPool[6,5])

D23 <- proportionsplot(dat = 7, setyaxis = c(proportions$PAlwaysPool[7,5]-(0.1*abs(proportions$PAlwaysPool[7,5]-proportions$PNeverPool[7,5])),
proportions$PNeverPool[7,5]+(0.1*abs(proportions$PAlwaysPool[7,5]-proportions$PNeverPool[7,5]))), 
xlim = c(0,1), TPFPalwayspool = proportions$PAlwaysPool[7,5], TPFPneverpool = proportions$PNeverPool[7,5])

D24 <- proportionsplot(dat = 8, setyaxis = c(proportions$PAlwaysPool[8,5]-(0.1*abs(proportions$PAlwaysPool[4,5]-proportions$PNeverPool[8,5])),
proportions$PNeverPool[8,5]+(0.1*abs(proportions$PAlwaysPool[8,5]-proportions$PNeverPool[8,5]))), 
xlim = c(0,1), TPFPalwayspool = proportions$PAlwaysPool[8,5], TPFPneverpool = proportions$PNeverPool[8,5])

arrangedfigure <- ggpubr::ggarrange(D11, D21, D12, D22, D13, D23, D14, D24, 
         labels = c(" A ", " B ","C1", "D1", "C2", "D2", "C3", "D3"),
        ncol = 2, nrow = 4, common.legend = TRUE, vjust = +0.2, hjust = -1.6, align = "hv", legend = "bottom")
 
annotatedfigureRMSTprop <- ggpubr::annotate_figure(arrangedfigure, 
               top = ggpubr::text_grob(expression(paste(lambda["c"],"= 776.89                                   ",lambda["c"],"= 876.89")), face = "bold", size = 20))

annotatedfigureRMSTprop
```

#########################
##### Together ##########
#########################


Save plot in 4.DataVisualization_output

```{r}
arrangedfigureProp <- ggpubr::ggarrange(annotatedfigureHRprop, annotatedfigureRMSTprop, 
      #  labels = c(" A ", " A "),
          ncol = 2, nrow = 1, common.legend = TRUE, align = "hv", legend = "bottom")

annotatedfigureProp <- ggpubr::annotate_figure(arrangedfigureProp, 
               top = ggpubr::text_grob("HR as final analysis                                                                                                                 RMST as final analysis", face = "bold", size = 15))

annotatedfigureProp

#saveplot
#ggsave("4.DataVisualization_output/prop2.png", plot = annotatedfigureProp, width = 20, height = 10)
```